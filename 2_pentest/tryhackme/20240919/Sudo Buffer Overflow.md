---
tags:
  - TryHackMe
  - CVE-2019-18634
---

# Walk Through

이 Machine은 `CVE-2019-18364`에 대해 실습할 수 있는 환경을 제공한다.

## CVE-2019-18364 이란 ?

> CVE-2019-18634 is, at the time of writing, the latest offering from Joe Vennix - the same guy who brought us the security bypass vulnerability that we used in the Security Bypass room. 
> 
> This one is slightly more technical, using a Buffer Overflow attack to get root permissions. It has been patched, but affects versions of sudo earlier than 1.8.26.

위는  해당 Machine의 Task2 단락에서 제시되는 "CVE-2019-18364"에 대한 설명이다. 요약하자면 `sudo`  명령어를 사용하는 경우 버전이 1.8.26 보다 낮을 경우 발생하는 취약점이다. 

이와 연관된 [데일리시큐](https://www.dailysecu.com/news/articleView.html?idxno=106430) 의 기사도 찾을 수 있었다. 데일리 시큐에서는 이 취약점이 Trigger되는 시점을 다음과 같이 설명하고 있다.
>Sudoers 구성 파일에서 pwfeedback 옵션이 활성화된 경우에만 취약점을 익스플로잇할 수 있다. Sudo의 pwfeedback 옵션을 사용하면, 사용자가 비밀번호를 입력할 때 시각적 피드백을 제공할 수 있다.
>
  NIST가 게시한 설명에 따르면 "1.8.26 이전 sudo에서 /etc/sudoeros에서 pwfeedback을 활성화시키면, 사용자는 권한있는 sudo 프로세스에서 스택 기반 버퍼 오버플로우를 트리거할 수 있다 
  > 
  Pwfeedback은 리눅스 Mint와 기본 OS의 기본 설정이지만, 업스트림 및 기타 여러 패키지의 기본 값은 아니며, 여러 관리자가 활성화한 경우에만 존재한다.
  
데일리 시큐에서 인용한 기사를 보면 Pwfeedback이 정확히 어떤 일을 하는지 이해가 되지 않는다. 그러나 이에 대해 TryHackMe에서 다음과 같이 설명된 부분을 찾을 수 있다.
  > If you have used Linux before then you might have noticed that passwords typed into the terminal usually don't show any output at all; `pwfeedback` makes it so that whenever you type a character, an asterisk is displayed on the screen
  > 
  > 이전에 Linux를 사용해 본 적이 있다면 터미널에 입력한 비밀번호가 전혀 출력되지 않는 것을 보셨을 텐데요, pwfeedback을 사용하면 문자를 입력할 때마다 별표가 화면에 표시되도록 할 수 있습니다.

정리해보자면 "CVE-2019-18364"는 pwfeedback을 이용한 buffer overflow 인 셈이다. 

## 예제 소스
buffer overflow는 perl이나 python을 이용해 프로그램 Argument에 대한 큰 입력을 가해야한다 그러나 이 과정은 스택 오버플로우가 터지는 시점을 잡기위한 과정에서 시간을 다소 소모한다.

이 Machine은 미리 "CVE-2019-18364"를 실습할 수 있게 expolit.c 파일을 제공한다.
- https://github.com/saleemrashid/sudo-cve-2019-18634


## SSH 접속하기
이제 실제로 Machine을 deploy 시켜 "CVE-2019-18364"에 대한 실습을 진행해보자. Machine의 설명에도 언급되어있지만 ssh로 접속하자.
```shell
╰─$ ssh -p 4444 tryhackme@10.10.198.136                                          
tryhackme@10.10.198.136's password:

```
password는 'tryhackme'이다. 

## Exploit
Machine에 접속하면 "exploit"이란 파일이 존재한다. 
```
tryhackme@sudo-bof:~$ ls
exploit  exploit.1
```
 이를 실행시키면 root 권한을 얻는다.
```shell
tryhackme@sudo-bof:~$ ./exploit
[sudo] password for tryhackme:
Sorry, try again.
# whoami
root
```
flag는 /root/root.txt 에서 읽을 수 있다.

 
 

  
  
  
  
 
 
 
 
  
